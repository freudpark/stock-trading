# Google Sheets 대시보드 설정 가이드

## 1. Google Sheets 파일 생성

### 1-1. 새 스프레드시트 생성

1. [Google Sheets](https://sheets.google.com)에 접속
2. **"+ 새로 만들기"** → **"스프레드시트"** 클릭
3. 파일명을 **"자동매매 투자 대시보드"**로 설정
4. 파일 ID를 복사하여 저장 (n8n 설정에 필요)
   - URL 예: `https://docs.google.com/spreadsheets/d/1a2b3c4d5e6f7g8h9i0j/edit`
   - 파일 ID: `1a2b3c4d5e6f7g8h9i0j`

---

## 2. 시트 구조 설정

### 2-1. 시트 1: "대시보드" (메인 대시보드)

이 시트는 투자 성과의 핵심 지표를 한눈에 볼 수 있는 요약 정보를 표시합니다.

#### 레이아웃:

```
┌─────────────────────────────────────────────────────┐
│            📊 투자 성과 대시보드                      │
├─────────────────────────────────────────────────────┤
│ 마지막 업데이트: 2025-10-28 09:00:00                 │
│ 오늘 매매 건수: 3건                                  │
│ 총 투자 금액: 10,000,000원                           │
│ 현재 보유 종목 수: 3개                               │
│ 누적 수익률: +1.28%                                 │
│ 오늘 수익률: -3.11%                                 │
└─────────────────────────────────────────────────────┘
```

#### 셀 설정:

| 셀 위치 | 내용 | 공식/값 |
| :--- | :--- | :--- |
| A1 | 📊 투자 성과 대시보드 | (텍스트) |
| A3 | 마지막 업데이트: | (텍스트) |
| B3 | [동적 업데이트] | `=NOW()` |
| A4 | 오늘 매매 건수: | (텍스트) |
| B4 | [동적 업데이트] | `=COUNTIFS('매매 로그'!A:A, TODAY())` |
| A5 | 총 투자 금액: | (텍스트) |
| B5 | [동적 업데이트] | `=SUMIF('매매 로그'!A:A, TODAY(), '매매 로그'!F:F)` |
| A6 | 현재 보유 종목 수: | (텍스트) |
| B6 | [동적 업데이트] | `=COUNTA('보유 종목'!A:A)-1` |
| A7 | 누적 수익률: | (텍스트) |
| B7 | [동적 업데이트] | `=SUM('보유 종목'!H:H)/COUNTA('보유 종목'!A:A)-1` |
| A8 | 오늘 수익률: | (텍스트) |
| B8 | [동적 업데이트] | `=SUMIF('매매 로그'!A:A, TODAY(), '매매 로그'!I:I)/COUNTIFS('매매 로그'!A:A, TODAY())` |

---

### 2-2. 시트 2: "매매 로그" (거래 기록)

이 시트는 모든 매매 거래 기록을 저장합니다. n8n 워크플로우가 자동으로 행을 추가합니다.

#### 헤더 행 (A1:J1):

| A | B | C | D | E | F | G | H | I | J |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 날짜 | 종목명 | 종목코드 | 점수 | 매매판단 | 투자금액 | 목표가 | 현재가 | 수익률(%) | 상태 |

#### 데이터 행 예시 (A2부터):

| 날짜 | 종목명 | 종목코드 | 점수 | 매매판단 | 투자금액 | 목표가 | 현재가 | 수익률(%) | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 2025-10-28 09:00 | 두산로보틱스 | 454910 | 6 | 매수 | 3,333,333 | 44,492 | 43,000 | -3.4% | 주문접수 |
| 2025-10-28 09:05 | 레인보우로보틱스 | 277810 | 6 | 매수 | 3,333,333 | 33,470 | 32,500 | -2.9% | 주문접수 |
| 2025-10-28 09:10 | 삼성전자 | 005930 | 4 | 매수 | 3,333,333 | 45,917 | 44,500 | -3.1% | 주문접수 |

#### 수익률 공식 (I열):

```
=(H2-G2)/G2*100
```

---

### 2-3. 시트 3: "보유 종목" (포트폴리오)

이 시트는 현재 보유 중인 종목의 포트폴리오 현황을 표시합니다.

#### 헤더 행 (A1:H1):

| A | B | C | D | E | F | G | H |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 종목명 | 종목코드 | 매수가 | 수량 | 현재가 | 평가금액 | 수익/손실 | 수익률(%) |

#### 데이터 행 예시 (A2부터):

| 종목명 | 종목코드 | 매수가 | 수량 | 현재가 | 평가금액 | 수익/손실 | 수익률(%) |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 두산로보틱스 | 454910 | 43,000 | 77 | 43,500 | 3,349,500 | 38,500 | +1.16% |
| 레인보우로보틱스 | 277810 | 32,500 | 102 | 33,000 | 3,366,000 | 51,000 | +1.54% |
| 삼성전자 | 005930 | 44,500 | 74 | 45,000 | 3,330,000 | -3,333 | -0.10% |

#### 공식:

- **F열 (평가금액):** `=D2*E2`
- **G열 (수익/손실):** `=(E2-C2)*D2`
- **H열 (수익률):** `=(E2-C2)/C2*100`

---

### 2-4. 시트 4: "수익률 추이" (그래프 데이터)

이 시트는 일별 수익률 추이를 기록하며, 그래프 생성에 사용됩니다.

#### 헤더 행 (A1:C1):

| A | B | C |
| :--- | :--- | :--- |
| 날짜 | 일일 수익률(%) | 누적 수익률(%) |

#### 데이터 행 예시 (A2부터):

| 날짜 | 일일 수익률(%) | 누적 수익률(%) |
| :--- | :--- | :--- |
| 2025-10-27 | -1.2 | -1.2 |
| 2025-10-28 | +0.6 | -0.6 |
| 2025-10-29 | +2.3 | +1.7 |

---

## 3. 조건부 서식 설정

### 3-1. 수익률 셀 색상 지정

1. **"보유 종목" 시트의 H열 선택** (수익률 데이터)
2. **"서식" → "조건부 서식" 클릭**
3. **"색상 눈금" 선택**
   - 최소값: 빨강 (음수)
   - 중간값: 흰색 (0%)
   - 최대값: 초록색 (양수)

### 3-2. 매매판단 셀 색상 지정

1. **"매매 로그" 시트의 E열 선택** (매매판단 데이터)
2. **"서식" → "조건부 서식" 클릭**
3. **"사용자 정의 공식 사용"** 선택
   - 공식: `=E2="매수"`
   - 배경색: 초록색

---

## 4. 그래프 생성

### 4-1. 수익률 추이 그래프

1. **"수익률 추이" 시트의 A1:C20 범위 선택**
2. **"삽입" → "차트" 클릭**
3. **차트 유형: 꺾은선형 차트 선택**
4. **차트 제목: "일별 수익률 추이"**
5. **X축: 날짜, Y축: 수익률**

### 4-2. 포트폴리오 구성 원형 차트

1. **"보유 종목" 시트의 A2:A10 (종목명)과 F2:F10 (평가금액) 선택**
2. **"삽입" → "차트" 클릭**
3. **차트 유형: 원형 차트 선택**
4. **차트 제목: "포트폴리오 구성"**

---

## 5. n8n과 Google Sheets 연동

### 5-1. Google Sheets 노드 설정

n8n 워크플로우에서 Google Sheets 노드를 추가할 때:

1. **"Authenticate with Google" 버튼 클릭**
2. **Google 계정으로 로그인**
3. **권한 승인 (Google Sheets API 접근)**
4. **스프레드시트 선택: "자동매매 투자 대시보드"**
5. **시트 선택: "매매 로그"**

### 5-2. 행 추가 설정

**노드 설정:**
- **작업:** Append Row
- **스프레드시트:** 자동매매 투자 대시보드
- **시트:** 매매 로그
- **값 (각 열에 해당):**
  1. `{{ now.toFormat('yyyy-MM-dd HH:mm:ss') }}` (날짜)
  2. `{{ $item.name }}` (종목명)
  3. `{{ $item.code }}` (종목코드)
  4. `{{ $item.score }}` (점수)
  5. `{{ $item.decision }}` (매매판단)
  6. `{{ $item.investment_amount }}` (투자금액)
  7. `{{ $item.target_price }}` (목표가)
  8. `{{ $json.details.current_price || $item.target_price }}` (현재가)
  9. `={{ (H2-G2)/G2*100 }}` (수익률 - 자동 계산)
  10. `{{ $json.status === "success" ? "주문접수" : "주문실패" }}` (상태)

---

## 6. 공유 및 접근 권한 설정

### 6-1. 스프레드시트 공유

1. **우측 상단의 "공유" 버튼 클릭**
2. **"링크 공유" 선택**
3. **권한: "편집자"로 설정**
4. **링크 복사하여 필요한 사람과 공유**

### 6-2. n8n 서비스 계정 추가 (선택사항)

더 안전한 자동화를 위해 서비스 계정을 사용할 수 있습니다:

1. **Google Cloud Console에서 서비스 계정 생성**
2. **JSON 키 파일 다운로드**
3. **n8n의 Google Sheets 노드에서 서비스 계정 키 입력**

---

## 7. 대시보드 모니터링

### 7-1. 실시간 모니터링

- Google Sheets를 열어두고 자동 새로고침 설정 (F5 또는 Ctrl+R)
- 모바일 앱에서도 실시간 확인 가능

### 7-2. 알림 설정

1. **"도구" → "알림 규칙" 클릭**
2. **조건 설정:**
   - 누적 수익률이 -5% 이하일 때
   - 오늘 매매 건수가 0일 때
   - 알림 방식: 이메일

---

## 8. 데이터 백업

### 8-1. 정기적 백업

1. **"파일" → "다운로드" → "Microsoft Excel (.xlsx)"**
2. **로컬 컴퓨터에 저장**
3. **주 1회 이상 백업 권장**

### 8-2. Google Drive 버전 관리

- Google Sheets는 자동으로 버전 관리 (최대 100개 버전 보관)
- **"파일" → "버전 기록" → "버전 관리"**에서 이전 버전 복구 가능

---

## 9. 트러블슈팅

### 9-1. n8n에서 Google Sheets 연동 실패

**문제:** "Access Denied" 에러

**해결:**
1. Google 계정의 2단계 인증 비활성화 (임시)
2. 또는 [Google 보안 설정](https://myaccount.google.com/security)에서 "보안 수준이 낮은 앱 허용"

### 9-2. 데이터가 자동으로 업데이트되지 않음

**문제:** Google Sheets에 데이터가 추가되지 않음

**해결:**
1. n8n 워크플로우 실행 로그 확인
2. Google Sheets API 활성화 여부 확인
3. 스프레드시트 공유 권한 재확인

---

## 10. 고급 기능

### 10-1. 자동 리포트 생성

Google Sheets의 "앱 스크립트"를 사용하여 자동으로 주간/월간 리포트 생성 가능

### 10-2. Slack 연동

n8n에서 Slack 노드를 추가하여, 매매 결과를 Slack 채널에 자동 전송 가능

### 10-3. Google Data Studio 대시보드

Google Sheets 데이터를 Google Data Studio와 연동하여 더 고급스러운 대시보드 생성 가능


